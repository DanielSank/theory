\levelstay{Coupling}

\leveldown{Capacitive coupling}

\begin{figure}
\begin{centering}
\includegraphics[width=6cm]{coupled_circuits_capacitive.pdf}
\par\end{centering}
\caption{Two circuits coupled through a capacitor $C_g$.}
\label{Fig:coupledCircuits_capacitive}
\end{figure}

The circuit shown in Fig.\,\ref{Fig:coupledCircuits_capacitive} has the following Lagrangian \begin{align}
\mathcal{L} = & \frac{1}{2}C_1\dot{\Phi}_1^2 + \frac{1}{2}C_2\dot{\Phi}_2^2 \nonumber \\
& + \frac{1}{2}C_g \left( \dot{\Phi}_1 - \dot{\Phi_2} \right)^2 \nonumber \\
& - \frac{1}{2L_1}\Phi_1^2 - \frac{1}{2L_2}\Phi_2^2 \, . \end{align}
The kinetic term can be rewritten as \begin{equation}
T = \frac{1}{2}
\left( \begin{array}{cc} \dot{\Phi}_1 & \dot{\Phi}_2 \end{array} \right)
\left( \begin{array}{cc} C_1' & -C_g \\ -C_g & C_2' \end{array} \right)
\left( \begin{array}{c} \dot{\Phi}_1 \\ \dot{\Phi}_2 \end{array} \right) \label{eq:kineticInFlux} \end{equation}
where $C_1' \equiv C_1+C_g$ and similarly for $C_2'$. The canonical momenta are \begin{eqnarray}
p_1 = \frac{dL}{d\dot{\Phi}_1} = C_1'\dot{\Phi}_1 - C_g\dot{\Phi}_2 \nonumber \\
p_2 = \frac{dL}{d\dot{\Phi}_2} = C_2'\dot{\Phi}_2 - C_g\dot{\Phi}_1 \end{eqnarray}
which can be written as \begin{equation}
\left( \begin{array}{c} p_1 \\ p_2 \end{array} \right) =
\left( \begin{array}{cc} C_1' & -C_g \\ -C_g & C_2' \end{array} \right)
\left( \begin{array}{c} \dot{\Phi}_1 \\ \dot{\Phi}_2 \end{array} \right) \end{equation}
Note the recurrence of the matrix from equation (\ref{eq:kineticInFlux}). Naming this matrix $M$ we can write \begin{eqnarray}
T &=& \frac{1}{2}
      \left( \begin{array}{cc} \dot{\Phi}_1&\dot{\Phi}_2 \end{array} \right)
      M
      \left( \begin{array}{c} \dot{\Phi}_1 \\ \dot{\Phi}_2 \end{array} \right) \label{eq:kineticWithM} \\
\left( \begin{array}{c} \dot{\Phi}_1 \\ \dot{\Phi}_2 \end{array} \right) &=& M^{-1} \left( \begin{array}{c} p_1 \\ p_2 \end{array} \right) \label{eq:fluxToMomenta} \end{eqnarray}
Substituting equation (\ref{eq:fluxToMomenta}) into (\ref{eq:kineticWithM}) and using the facts that matrix transposition commutes with matrix inversion and that $M$ is symmetric we get
\begin{equation}
T = \frac{1}{2} \left( \begin{array}{cc} p_1&p_2 \end{array} \right) M^{-1} \left( \begin{array}{c} p_1 \\ p_2 \end{array} \right) \, .
\end{equation}
The inverse of the 2x2 matrix $M$ is
\begin{align}
M^{-1} &= \frac{1}{C_1C_2 + C_g(C_1 + C_2)} \left( \begin{array}{cc} C_2' & C_g \\ C_g & C_1' \end{array} \right) \nonumber \\
&\equiv \left( \begin{array}{cc} 1/C_1'' & 1/C_g'' \\ 1/C_g'' & 1/C_2'' \end{array} \right) \, .
\end{align}
Finally, the kinetic term of the Langrangian is \begin{equation}
T = \frac{p_1^2}{2C_1''} + \frac{p_2^2}{2C_2''} + \frac{p_1p_2}{C_g''} \, . \label{eq:kineticInP}
\end{equation}

Let us now understand the quantities $C_1''$ and $C_2''$ in a simple way.
The capacitance to ground from the signal node of circuit 1 is \begin{eqnarray}
C_{1,\textrm{total}} &=& C_1||(C_g \textrm{ in series with } C_2) \nonumber \\
&=& C_1 + \frac{C_g C_2}{C_g+C_2} \nonumber \\
&=& \frac{C_1 C_2 + C_g(C_1+C_2)}{C_g+C_2} \nonumber \end{eqnarray}
which is exactly equal to our expression for $C_1''$.
Therefore we've found that \textbf{the effective capacitance associated with the the canonical charge is just the capacitance to ground of the conjugate flux's signal node}.

The quantities $p_1$ and $p_2$ have dimensions of charge so we will rename them $\tilde{Q}_1$ and $\tilde{Q}_2$.
The tildes remind us that they are not the usual single qubit charges.

The coupling term in the Hamiltonian, eq.\,(\ref{eq:kineticInP}), is \begin{equation}
H_g = \frac{ \tilde{Q}_1 \tilde{Q}_2} {C_g''}. \label{eq:sec:coupling:H_g} \end{equation}
We would like to re-express it in terms of Pauli operators.
If we use the (very good) approximation that the normal modes are harmonic we can rewrite the charge operators as \begin{equation}
\tilde{Q} = -i Q_{\textrm{zpf}} (a - a^{\dagger}) \, . \end{equation}
The parameter $Q_{\textrm{zpf}}$ is the rms zero point fluctuations in charge and is given by (see \citeinternaltype \citeinternalref{quantumOscillator}) \begin{equation}
Q_{\textrm{zpf}} = \sqrt{\frac{\hbar}{2Z}} = \sqrt{\frac{\hbar \omega C}{2}} \, . \end{equation}
Substitution of this expression for the $\tilde{Q}$ coordinates turns the coupling Hamiltonian into
\begin{align}
H_g &= \frac{Q_{1,\textrm{zpf}}Q_{2,\textrm{zpf}}}{C_g''}(-i)(a_1-a_1^{\dagger})(-i)(a_2-a_2^{\dagger}) \nonumber \\
&= \frac{\hbar}{2}\sqrt{\omega_1\omega_2 C_1'' C_2''}\frac{C_g}{C_1C_2 + C_g(C_1+C_2)}(\sigma_y \otimes \sigma_y) \nonumber \\
&= \frac{1}{2}\frac{C_g}{\sqrt{C_1' C_2'}} \hbar\sqrt{\omega_1\omega_2} (\sigma_y \otimes \sigma_y) \nonumber
\end{align}
where we have again used a two level approximation \mbox{$a - a^\dagger \rightarrow i \sigma_y$}.
We combine the prefactors into a parameter $g$ and write the Hamiltonian as \begin{equation}
H_g = g \left( \sigma_y \otimes \sigma_y \right) \end{equation}
where $g$, called the ``coupling strength'', is defined as \begin{equation}
g \equiv \frac{1}{2} \frac{C_g}{\sqrt{C_1' C_2'}} \hbar\sqrt{\omega_1\omega_2} \, . \end{equation}
Taking $C_1 \approx C_2$ and $\omega_1 \approx \omega_2$, then using $C = 1 / \omega Z_{LC}$ we find
\begin{equation}
g \propto Z_{LC} \, .
\end{equation}

\levelstay{Summary - Simple derivation}

The energy in the coupling capacitor is
\begin{equation}
E_g = \frac{1}{2} C_g \left( V_1 - V_2 \right)^2 \, . \nonumber
\end{equation}
Keeping only the term which couples the qubits, we find \begin{equation}
E_g = -C_g V_1 V_2 = -C_g \frac{Q_1}{C_1} \frac{Q_2}{C_2} . \end{equation}
This matches Eq.\,(\ref{eq:sec:coupling:H_g}), up to the sign, in the practical limit $C_1,C_2 \gg C_g$.

\levelstay{Inductive Coupling}

\begin{figure}
\begin{centering}
\includegraphics[width=6cm]{coupled_circuits_inductive.pdf}
\par\end{centering}
\caption{Two circuits coupled through a mutual inductance $M$.}
\label{Fig:coupledCircuits_inductive}
\end{figure}


Consider the circuit shown in Figure \ref{Fig:coupledCircuits_inductive}.
From Kirchoff's laws we find that the equations of motion for the system are
\begin{align}
\omega_1^2 Q_1 &= -\ddot{Q}_1 - \left(M/L_1\right) \ddot{Q}_2 \\
\omega_2^2 Q_2 &= -\ddot{Q}_2 - \left(M/L_2\right) \ddot{Q}_1
\end{align}
These equations of motion can be derived from the following Lagrangian
\begin{equation}
\mathcal{L} = \frac{Q_1^2}{2 C_1} + \frac{Q_2^2}{2 C_2}
- \frac{L_1}{2}\dot{Q}_1^2
- \frac{L_2}{2}\dot{Q}_2^2
- M \dot{Q}_1 \dot{Q}_2 \, . \label{eq:sec.coupling.subsec.inductiveCoupling:Lagrangian}
\end{equation}

In this Lagrangian the charges have appeared as the coordinate variables.
This is annoying because in all of our previous analysis we regarded the fluxes as the coordinates and the charges as the conjugate momenta.
To convert to using flux as the coordinate, we note that the $\dot{Q}$ are the loop currents, and we relate the currents to the fluxes using the definition of inductance and mutual inductance:
\begin{align}
\Phi_1 &= L_1 I_1 + M I_2 \\
\Phi_2 &= M I_1 + L_2 I_2 \, .
\end{align}
These equations are rewritten as a matrix equation
\begin{align}
\left( \begin{array}{c} \Phi_1 \\ \Phi_2 \end{array} \right) &=
\left[ \begin{array}{cc} L_1 & M \\ M & L_2 \end{array} \right]
\left( \begin{array}{c} I_1 \\ I_2 \end{array} \right) \\
\ket{\Phi} &= \mathbf{M} \ket{I} \label{eq:sec.coupling.subsec.inductiveCoupling:fluxToI} \, .
\end{align}
Next, using $\dot{Q}=I$, note that the dotted terms in Eq.\,(\ref{eq:sec.coupling.subsec.inductiveCoupling:Lagrangian}) can also be written as a matrix expression:
\begin{equation}
-\frac{1}{2} \bbraket{I}{\mathbf{M}}{I} \, .
\end{equation}
Therefore, by using Eq.\,(\ref{eq:sec.coupling.subsec.inductiveCoupling:fluxToI}) in Eq.\,(\ref{eq:sec.coupling.subsec.inductiveCoupling:Lagrangian}) we can rewrite the Lagrangian as
\begin{equation}
\mathcal{L} =
\frac{Q_1^2}{2 C_1} + \frac{Q_2^2}{2 C_2}
- \frac{1}{2} \bbraket{\Phi}{\mathbf{M}^{-1}}{\Phi} \, .
\end{equation}
To get a true Lagrangian we have to express the charges in terms of flux.
Using the definition of capacitance, $C = Q/V$, and noting that the \emph{total} flux through each inductor is the time integral of the voltage, we have
\begin{equation}
\frac{1}{2}\frac{Q^2}{C} = \frac{1}{2}C \dot{\Phi}^2 \, .
\end{equation}
Using this and expanding $\mathbf{M}^{-1}$ we finally arrive at
\begin{align}
\mathcal{L} &=
\frac{1}{2}C_1 \dot{\Phi}_1^2 + \frac{1}{2}C_2 \dot{\Phi}_2^2 \\
&- \left( \frac{1}{1 - M^2 / L_1L_2} \right)
\left( \frac{\Phi_1^2}{2L_1} + \frac{\Phi_2^2}{2L_2} \right) \\
&+ \left( \frac{1}{1 - M^2 / L_1 L_2} \right) \frac{M}{L_1 L_2} \Phi_1 \Phi_2 \, .
\end{align}
Thus we have reformulated the Lagrangian with the fluxes as the coordinates.

The conjugate momenta are
\begin{equation}
p = \frac{\partial \mathcal{L}}{\partial \dot{\Phi}} = C \dot{\Phi} = Q \, .
\end{equation}
The Hamiltonian is
\begin{align}
H &= \sum_i Q_i \dot{\Phi}_i - \mathcal{L} \\
&= \frac{Q_1^2}{2 C_1} + \frac{Q_2^2}{2 C_2} \\
&+ \left( \frac{1}{1 - M^2 / L_1L_2} \right)
\left( \frac{\Phi_1^2}{2L_1} + \frac{\Phi_2^2}{2L_2} \right) \\
&+ \left( \frac{1}{1 - M^2 / L_1 L_2} \right) \frac{M}{L_1 L_2} \Phi_1 \Phi_2 \, .
\end{align}

