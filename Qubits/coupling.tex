\levelstay{Coupling}

\leveldown{Capacitive coupling}

\begin{figure}
\begin{centering}
\includegraphics[width=6cm]{coupled_circuits_capacitive.pdf}
\par\end{centering}
\caption{Two circuits coupled through a capacitor $C_g$.}
\label{Fig:coupledCircuits_capacitive}
\end{figure}

The circuit shown in Fig.\,\ref{Fig:coupledCircuits_capacitive} has the following Lagrangian
\begin{align}
  \mathcal{L} = & \frac{1}{2}C_1\dot{\Phi}_1^2 + \frac{1}{2}C_2\dot{\Phi}_2^2 \nonumber \\
  & + \frac{1}{2}C_g \left( \dot{\Phi}_1 - \dot{\Phi_2} \right)^2 \nonumber \\
  & - \frac{1}{2L_1}\Phi_1^2 - \frac{1}{2L_2}\Phi_2^2 \, .
\end{align}
The kinetic term can be rewritten as
\begin{equation}
  T = \frac{1}{2}
  \left( \begin{array}{cc} \dot{\Phi}_1 & \dot{\Phi}_2 \end{array} \right)
  \left( \begin{array}{cc} C_1 + C_g & -C_g \\ -C_g & C_2 + C_g \end{array} \right)
  \left( \begin{array}{c} \dot{\Phi}_1 \\ \dot{\Phi}_2 \end{array} \right) \label{eq:kineticInFlux}
  \, .
\end{equation}
The canonical momenta are
\begin{align}
  Q_1 &= \frac{d \mathcal{L}}{d\dot{\Phi}_1} = (C_1 + C_g) \dot{\Phi}_1 - C_g\dot{\Phi}_2 \nonumber \\
  Q_2 &= \frac{d \mathcal{L}}{d\dot{\Phi}_2} = (C_2 + C_g) \dot{\Phi}_2 - C_g\dot{\Phi}_1
\end{align}
which can be written as
\begin{equation}
  \left( \begin{array}{c} Q_1 \\ Q_2 \end{array} \right) =
  \left( \begin{array}{cc} C_1 + C_g & -C_g \\ -C_g & C_2 + C_g \end{array} \right)
  \left( \begin{array}{c} \dot{\Phi}_1 \\ \dot{\Phi}_2 \end{array} \right)
  \, .
\end{equation}
Note the recurrence of the matrix from equation (\ref{eq:kineticInFlux}).
Naming this matrix $M$ we can write
\begin{align}
  T &=
    \frac{1}{2}
    \left( \begin{array}{cc} \dot{\Phi}_1 \dot{\Phi}_2 \end{array} \right)
    M
    \left( \begin{array}{c} \dot{\Phi}_1 \\ \dot{\Phi}_2 \end{array} \right)
    \label{eq:kineticWithM} \\
  \text{and} \qquad
  \left( \begin{array}{c} \dot{\Phi}_1 \\ \dot{\Phi}_2 \end{array} \right)
  &= M^{-1}
  \left( \begin{array}{c} Q_1 \\ Q_2 \end{array} \right) \, .
  \label{eq:fluxToMomenta}
\end{align}
Substituting equation (\ref{eq:fluxToMomenta}) into (\ref{eq:kineticWithM}) and using the facts that matrix transposition commutes with matrix inversion and that $M$ is symmetric we can rewrite the kinetic term as
\begin{equation}
  T =
  \frac{1}{2} \left( \begin{array}{cc} Q_1 & Q_2 \end{array} \right)
  M^{-1}
  \left( \begin{array}{c} Q_1 \\ Q_2 \end{array} \right) \, .
\end{equation}
Finding the inverse of $M$ to be
\begin{align}
  M^{-1}
  &= \frac{1}{C_1 C_2 + C_1 C_g + C_2 C_g}
    \left( \begin{array}{cc} C_2 + C_g & C_g \\ C_g & C_1 + C_g \end{array} \right) \nonumber \\
  &\equiv \left(
    \begin{array}{cc} 1/C_1' & 1/C_g' \\ 1/C_g' & 1/C_2' \end{array}
    \right) \, ,
\end{align}
we can write the kinetic term of the Langrangian as
\begin{equation}
  T =
      \frac{Q_1^2}{2 C_1'}
    + \frac{Q_2^2}{2 C_2'}
    + \frac{Q_1 Q_2}{C_g'} \, . \label{eq:kineticInP}
\end{equation}

Let us understand the quantities $C_1'$ and $C_2'$ in a simple way.
The capacitance to ground from the signal node of circuit 1 is
\begin{align*}
  C_{1, \textrm{total}}
  &= C_1 || (C_g \textrm{ in series with } C_2) \\
  &= \frac{C_1 C_2 + C_g(C_1+C_2)}{C_g+C_2}
\end{align*}
which is exactly equal to our expression for $C_1'$.
Therefore we've found that the effective capacitance associated with the canonical charge is just the capacitance to ground of the conjugate flux's signal node!

The complete coupled Hamiltonian is therefore
\begin{equation}
  H =
    \frac{\Phi_1^2}{2 L_1}
  + \frac{\Phi_2^2}{2 L_2}
  + \frac{Q_1^2}{2 C_1'}
  + \frac{Q_2^2}{2 C_2'}
  + \frac{Q_1 Q_2}{C_g'} \, .
\end{equation}
Note that in the limit $C_g \ll C_1, C_2$ the primed quantities are, to first order in $C_g / C_1$ or $C_g / C_2$,
\begin{align*}
  C_1' & \approx C_1 + C_g \\
  C_2' & \approx C_2 + C_g \\
  \frac{1}{C_g'} & \approx \frac{C_g}{C_1 C_2} \, .
\end{align*}

The coupling term in the Hamiltonian, eq.\,(\ref{eq:kineticInP}), is
\begin{equation}
  H_g = \frac{ Q_1 Q_2} {C_g'} \, . \label{eq:sec:coupling:H_g}
\end{equation}
We would like to re-express it in terms of Pauli operators.
Using again the harmonic limit expression
\begin{equation}
  \tilde{Q} = -i Q_{\textrm{zpf}} (a - a^{\dagger}) \, ,
\end{equation}
we get
\begin{align*}
  H_g
  &= \frac{Q_{1,\textrm{zpf}}Q_{2,\textrm{zpf}}}{C_g'}
    (-i)(a_1 - a_1^{\dagger}) (-i)(a_2 - a_2^{\dagger}) \\
  &= \frac{\hbar}{2} \sqrt{\omega_1' \omega_2' C_1' C_2'}
    \frac{C_g}{C_1 C_2 + C_g(C_1 + C_2)} (\sigma_y \otimes \sigma_y) \\
  &= \frac{1}{2}\frac{C_g}{\sqrt{(C_1 + C_g) (C_2 + C_g)}} \hbar
    \sqrt{\omega_1' \omega_2'} (\sigma_y \otimes \sigma_y)
\end{align*}
where $\omega_i' \equiv 1 / \sqrt{L_i C_i'}$ and where we have used a two level approximation \mbox{$a - a^\dagger \rightarrow i \sigma_y$}.
Defining the ``coupling strength'' $g$ as
\begin{equation}
  g \equiv \frac{1}{2} \frac{C_g}{\sqrt{(C_1 + C_g) (C_2 + C_g)}} \hbar \sqrt{\omega_1' \omega_2'}
\end{equation}
we can rewrite the coupling Hamiltonian as
\begin{equation}
  H_g = g \left( \sigma_y \otimes \sigma_y \right) \, .
\end{equation}
Taking $C_1 \approx C_2$ and $\omega_1 \approx \omega_2$, then using $C = 1 / \omega Z_{LC}$ we find
\begin{equation}
  g \propto Z_{LC} \, .
\end{equation}

\levelstay{Summary - Simple derivation}

The energy in the coupling capacitor is
\begin{equation}
E_g = \frac{1}{2} C_g \left( V_1 - V_2 \right)^2 \, . \nonumber
\end{equation}
Keeping only the term which couples the qubits, we find \begin{equation}
E_g = -C_g V_1 V_2 = -C_g \frac{Q_1}{C_1} \frac{Q_2}{C_2} . \end{equation}
This matches Eq.\,(\ref{eq:sec:coupling:H_g}), up to the sign, in the practical limit $C_1,C_2 \gg C_g$.

\levelstay{Inductive Coupling}

\begin{figure}
\begin{centering}
\includegraphics[width=6cm]{coupled_circuits_inductive.pdf}
\par\end{centering}
\caption{Two circuits coupled through a mutual inductance $M$.}
\label{Fig:coupledCircuits_inductive}
\end{figure}


Consider the circuit shown in Figure \ref{Fig:coupledCircuits_inductive}.
From Kirchhoff's laws we find that the equations of motion for the system are
\begin{align}
\omega_1^2 Q_1 &= -\ddot{Q}_1 - \left(M/L_1\right) \ddot{Q}_2 \\
\omega_2^2 Q_2 &= -\ddot{Q}_2 - \left(M/L_2\right) \ddot{Q}_1
\end{align}
These equations of motion can be derived from the following Lagrangian
\begin{equation}
\mathcal{L} = \frac{Q_1^2}{2 C_1} + \frac{Q_2^2}{2 C_2}
- \frac{L_1}{2}\dot{Q}_1^2
- \frac{L_2}{2}\dot{Q}_2^2
- M \dot{Q}_1 \dot{Q}_2 \, . \label{eq:sec.coupling.subsec.inductiveCoupling:Lagrangian}
\end{equation}

In this Lagrangian the charges have appeared as the coordinate variables.
This is annoying because in all of our previous analysis we regarded the fluxes as the coordinates and the charges as the conjugate momenta.
To convert to using flux as the coordinate, we note that the $\dot{Q}$ are the loop currents, and we relate the currents to the fluxes using the definition of inductance and mutual inductance:
\begin{align}
\Phi_1 &= L_1 I_1 + M I_2 \\
\Phi_2 &= M I_1 + L_2 I_2 \, .
\end{align}
These equations are rewritten as a matrix equation
\begin{align}
\left( \begin{array}{c} \Phi_1 \\ \Phi_2 \end{array} \right) &=
\left[ \begin{array}{cc} L_1 & M \\ M & L_2 \end{array} \right]
\left( \begin{array}{c} I_1 \\ I_2 \end{array} \right) \\
\ket{\Phi} &= \mathbf{M} \ket{I} \label{eq:sec.coupling.subsec.inductiveCoupling:fluxToI} \, .
\end{align}
Next, using $\dot{Q}=I$, note that the dotted terms in Eq.\,(\ref{eq:sec.coupling.subsec.inductiveCoupling:Lagrangian}) can also be written as a matrix expression:
\begin{equation}
-\frac{1}{2} \bbraket{I}{\mathbf{M}}{I} \, .
\end{equation}
Therefore, by using Eq.\,(\ref{eq:sec.coupling.subsec.inductiveCoupling:fluxToI}) in Eq.\,(\ref{eq:sec.coupling.subsec.inductiveCoupling:Lagrangian}) we can rewrite the Lagrangian as
\begin{equation}
\mathcal{L} =
\frac{Q_1^2}{2 C_1} + \frac{Q_2^2}{2 C_2}
- \frac{1}{2} \bbraket{\Phi}{\mathbf{M}^{-1}}{\Phi} \, .
\end{equation}
To get a true Lagrangian we have to express the charges in terms of flux.
Using the definition of capacitance, $C = Q/V$, and noting that the \emph{total} flux through each inductor is the time integral of the voltage, we have
\begin{equation}
\frac{1}{2}\frac{Q^2}{C} = \frac{1}{2}C \dot{\Phi}^2 \, .
\end{equation}
Using this and expanding $\mathbf{M}^{-1}$ we finally arrive at
\begin{align}
\mathcal{L} &=
\frac{1}{2}C_1 \dot{\Phi}_1^2 + \frac{1}{2}C_2 \dot{\Phi}_2^2 \\
&- \left( \frac{1}{1 - M^2 / L_1L_2} \right)
\left( \frac{\Phi_1^2}{2L_1} + \frac{\Phi_2^2}{2L_2} \right) \\
&+ \left( \frac{1}{1 - M^2 / L_1 L_2} \right) \frac{M}{L_1 L_2} \Phi_1 \Phi_2 \, .
\end{align}
Thus we have reformulated the Lagrangian with the fluxes as the coordinates.

The conjugate momenta are
\begin{equation}
p = \frac{\partial \mathcal{L}}{\partial \dot{\Phi}} = C \dot{\Phi} = Q \, .
\end{equation}
The Hamiltonian is
\begin{align}
  H
  &= \sum_i Q_i \dot{\Phi}_i - \mathcal{L} \nonumber \\
  &= \frac{Q_1^2}{2 C_1} + \frac{Q_2^2}{2 C_2} \nonumber \\
  &+ \left( \frac{1}{1 - M^2 / L_1L_2} \right)
    \left( \frac{\Phi_1^2}{2L_1} + \frac{\Phi_2^2}{2L_2} \right) \nonumber \\
  &- \left( \frac{1}{1 - M^2 / L_1 L_2} \right) \frac{M}{L_1 L_2} \Phi_1 \Phi_2 \, .
\end{align}
In the practical limit $L_1,L_2 \gg M$, this simplifies to
\begin{equation}
  H =
    \frac{Q_1^2}{2C_1} + \frac{Q_2^2}{2C_2}
  + \frac{\Phi_1^2}{2L_1} + \frac{\Phi_2^2}{2L_2}
  - \frac{M}{L_1 L_2} \Phi_1 \Phi_2
\end{equation}
where the first two terms are the usual potential and kinetic energies of two harmonic oscillators, and the final term is the coupling.
